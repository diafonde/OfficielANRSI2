<div class="appels-hero">
  <div class="container">
    <h1>{{ content?.heroTitle || 'Appels à Candidatures' }}</h1>
  </div>
  <div class="hero-overlay"></div>
</div>

<div class="container" *ngIf="isLoading">
  <div class="loading-container">
    <div class="loading">Loading...</div>
  </div>
</div>

<div class="container" *ngIf="!isLoading && content">
  <section class="section appels-section">
    <div class="breadcrumb">
      <a routerLink="/">Accueil</a>
      <span>»</span>
      <span>Appels à Candidatures</span>
    </div>
    
    <h2 class="page-title">Appels à Candidatures</h2>
    
    <div class="appels-list" *ngIf="content.appels && content.appels.length > 0">
      <article class="appel-article" *ngFor="let appel of content.appels; let i = index">
        <div class="article-content-wrapper">
          <div class="article-image" *ngIf="appel.imageUrl">
            <img [src]="getImageUrl(appel.imageUrl)" [alt]="appel.title" (error)="onImageError($event)" loading="lazy" />
          </div>
          <div class="article-text-content">
            <h3 class="article-title">{{ appel.title }}</h3>
            <p class="article-summary" *ngIf="appel.summary">
              {{ appel.summary }}
            </p>
            <div class="article-description-wrapper" *ngIf="appel.fullText || appel.description">
              <p class="article-description">
                {{ getDisplayText(appel, i) }}
              </p>
              <button 
                *ngIf="hasMoreText(appel)"
                type="button"
                class="read-more-btn"
                (click)="toggleExpand(i)"
                [attr.aria-expanded]="isExpanded(i)">
                {{ getReadMoreText(i) }}
              </button>
            </div>
            <div class="article-meta">
              <span class="article-date" *ngIf="getAppelDate(appel)">
                {{ getAppelDate(appel) }}
              </span>
            </div>
            <div class="article-actions" *ngIf="appel.actions && appel.actions.length > 0">
              <a 
                *ngFor="let action of appel.actions" 
                [href]="action.url" 
                class="learn-more-link"
                [target]="action.url.startsWith('http') ? '_blank' : '_self'"
                [rel]="action.url.startsWith('http') ? 'noopener noreferrer' : null">
                {{ action.text || (currentLang === 'ar' ? 'المزيد' : (currentLang === 'en' ? 'Learn more' : 'En savoir plus')) }} à propos de {{ appel.title }}
              </a>
            </div>
            <div class="article-documents" *ngIf="getDocumentUrls(appel).length > 0">
              <div class="documents-label" *ngIf="getDocumentUrls(appel).length > 1">
                <strong>{{ getDocumentsLabel() }} ({{ getDocumentUrls(appel).length }})</strong>
              </div>
              <div class="document-link" *ngFor="let documentUrl of getDocumentUrls(appel); let docIndex = index">
                <span class="document-number" *ngIf="getDocumentUrls(appel).length > 1">{{ docIndex + 1 }}.</span>
                <i class="fas" [ngClass]="getFileIconClass(documentUrl)"></i>
                <a 
                  [href]="getDocumentUrl(documentUrl)" 
                  [download]="getFileNameFromUrl(documentUrl)"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="document-download-link">
                  <span class="document-name">{{ getFileNameFromUrl(documentUrl) }}</span>
                  <i class="fas fa-download"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
      </article>
    </div>
    
    <div class="no-appels" *ngIf="!content.appels || content.appels.length === 0">
      <p>Aucun appel à candidatures disponible pour le moment.</p>
    </div>
  </section>
</div>

