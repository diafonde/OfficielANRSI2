<div class="articles-page">
  <div class="page-header">
    <div class="header-content">
      <h1>{{ 'ADMIN_ARTICLES_TITLE' | translate }}</h1>
      <p>{{ 'ADMIN_ARTICLES_DESCRIPTION' | translate }}</p>
    </div>
    <a routerLink="/admin/articles/new" class="btn btn-primary">
      <i class="fas fa-plus"></i>
      {{ 'ADMIN_ARTICLES_NEW' | translate }}
    </a>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="search-box">
      <i class="fas fa-search"></i>
      <input
        type="text"
        [placeholder]="'ADMIN_ARTICLES_SEARCH_PLACEHOLDER' | translate"
        (input)="onSearchChange($event)"
        class="search-input"
      >
    </div>
  </div>

  <!-- Articles Table -->
  <ng-container *ngIf="getFilteredArticles() | async as articles">
    <div class="articles-table">
      <div class="table-header">
        <div class="table-row">
          <div class="col-image">{{ 'ADMIN_ARTICLES_COL_IMAGE' | translate }}</div>
          <div class="col-title">{{ 'ADMIN_ARTICLES_COL_TITLE' | translate }}</div>
          <div class="col-languages">{{ 'ADMIN_ARTICLES_COL_LANGUAGES' | translate }}</div>
          <div class="col-author">{{ 'ADMIN_ARTICLES_COL_AUTHOR' | translate }}</div>
          <div class="col-featured">{{ 'ADMIN_ARTICLES_COL_FEATURED' | translate }}</div>
          <div class="col-date">{{ 'ADMIN_ARTICLES_COL_DATE' | translate }}</div>
          <div class="col-actions">{{ 'ADMIN_ARTICLES_COL_ACTIONS' | translate }}</div>
        </div>
      </div>

      <div class="table-body" *ngIf="articles.length > 0">
        <div class="table-row article-row" *ngFor="let article of articles">
          <div class="col-image">
            <img [src]="article.imageUrl" [alt]="article.title" class="article-thumb">
          </div>
          <div class="col-title">
            <div class="title-content">
              <h3>{{ article.title }}</h3>
              <p class="excerpt">{{ article.excerpt }}</p>
            </div>
          </div>
          <div class="col-languages">
            <div class="mobile-label">{{ 'ADMIN_ARTICLES_COL_LANGUAGES' | translate }}:</div>
            <div class="language-status">
              <span class="lang-badge" [class.available]="hasTranslation(article, 'fr')" [title]="'ADMIN_ARTICLES_LANG_FR' | translate">
                ðŸ‡«ðŸ‡·
              </span>
              <span class="lang-badge" [class.available]="hasTranslation(article, 'ar')" [title]="'ADMIN_ARTICLES_LANG_AR' | translate">
                ðŸ‡²ðŸ‡·
              </span>
              <span class="lang-badge" [class.available]="hasTranslation(article, 'en')" [title]="'ADMIN_ARTICLES_LANG_EN' | translate">
                ðŸ‡ºðŸ‡¸
              </span>
            </div>
          </div>
          <div class="col-author">
            <div class="mobile-label">{{ 'ADMIN_ARTICLES_COL_AUTHOR' | translate }}:</div>
            <span class="author-name">{{ article.author }}</span>
          </div>
          <div class="col-featured">
            <div class="mobile-label">{{ 'ADMIN_ARTICLES_COL_FEATURED' | translate }}:</div>
            <button 
              class="featured-toggle" 
              [class.active]="article.featured"
              (click)="toggleFeatured(article)"
              [title]="(article.featured ? 'ADMIN_ARTICLES_FEATURED_REMOVE' : 'ADMIN_ARTICLES_FEATURED_MARK') | translate">
              <i class="fas fa-star" [class.filled]="article.featured"></i>
              <span class="featured-label">{{ (article.featured ? 'ADMIN_ARTICLES_FEATURED' : 'ADMIN_ARTICLES_NOT_FEATURED') | translate }}</span>
            </button>
          </div>
          <div class="col-date">
            <div class="mobile-label">{{ 'ADMIN_ARTICLES_COL_DATE' | translate }}:</div>
            <span class="date-text">{{ formatDate(article.publishDate) }}</span>
          </div>
          <div class="col-actions">
            <div class="action-buttons">
              <a [routerLink]="['/admin/articles/edit', article.id]" class="btn btn-sm btn-outline">
                <i class="fas fa-edit"></i>
                <span class="btn-text">{{ 'ADMIN_ARTICLES_EDIT' | translate }}</span>
              </a>
              <button (click)="deleteArticle(article.id)" class="btn btn-sm btn-danger">
                <i class="fas fa-trash"></i>
                <span class="btn-text">{{ 'ADMIN_ARTICLES_DELETE' | translate }}</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="table-footer" *ngIf="articles.length === 0">
        <div class="empty-state">
          <i class="fas fa-newspaper"></i>
          <h3>{{ 'ADMIN_ARTICLES_NO_ARTICLES' | translate }}</h3>
          <p>{{ 'ADMIN_ARTICLES_NO_ARTICLES_DESC' | translate }}</p>
          <a routerLink="/admin/articles/new" class="btn btn-primary">
            <i class="fas fa-plus"></i>
            {{ 'ADMIN_ARTICLES_CREATE' | translate }}
          </a>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Pagination -->
  <div class="pagination-container" *ngIf="(getTotalArticlesCount() | async) as totalCount">
    <div class="pagination-info" *ngIf="totalCount > 0">
      <span>
        {{ 'ADMIN_ARTICLES_PAGINATION_SHOWING' | translate: {start: (currentPage - 1) * itemsPerPage + 1, end: Math.min(currentPage * itemsPerPage, totalCount), total: totalCount} }}
      </span>
    </div>
    <div class="pagination" *ngIf="totalPages > 1">
      <button 
        class="pagination-btn" 
        [class.disabled]="currentPage === 1"
        (click)="previousPage()"
        [disabled]="currentPage === 1">
        <i class="fas fa-chevron-left"></i>
        <span>{{ 'ADMIN_ARTICLES_PAGINATION_PREVIOUS' | translate }}</span>
      </button>
      
      <div class="page-numbers">
        <button 
          *ngIf="currentPage > 3 && totalPages > 5"
          class="page-number"
          (click)="goToPage(1)">
          1
        </button>
        <span *ngIf="currentPage > 3 && totalPages > 5" class="page-ellipsis">...</span>
        
        <button 
          *ngFor="let page of getPageNumbers()"
          class="page-number"
          [class.active]="page === currentPage"
          (click)="goToPage(page)">
          {{ page }}
        </button>
        
        <span *ngIf="currentPage < totalPages - 2 && totalPages > 5" class="page-ellipsis">...</span>
        <button 
          *ngIf="currentPage < totalPages - 2 && totalPages > 5"
          class="page-number"
          (click)="goToPage(totalPages)">
          {{ totalPages }}
        </button>
      </div>
      
      <button 
        class="pagination-btn" 
        [class.disabled]="currentPage === totalPages"
        (click)="nextPage()"
        [disabled]="currentPage === totalPages">
        <span>{{ 'ADMIN_ARTICLES_PAGINATION_NEXT' | translate }}</span>
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>
</div>
